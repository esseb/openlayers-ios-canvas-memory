<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>OpenLayers iOS Canvas Memory Demonstration</title>
    <style>
      body {
        margin: 0;
      }

      .toolbar {
        background-color: white;
        line-height: 24px;
        padding: 12px;
        z-index: 1; /* Render in front of the map */
      }

      .map {
        height: 400px;
      }

      h1,
      h2 {
        font-size: 1em;
        margin: 0;
      }

      p {
        margin: 0 0 0.5em 0;
      }
    </style>
  </head>

  <body>
    <div class="toolbar">
      <h1>OpenLayers iOS Canvas Memory Demonstration</h1>

      <ol>
        <li>Open this page in Safari on an iPhone running iOS 12</li>
        <li>
          Debug Safari on iPhone via Safari on Mac if possible and open the
          devtools console tab
        </li>
        <li>The map should load without any problems</li>
        <li>
          Click the "Destroy map" button below then the "Create map" button
        </li>
        <li>Repeat step 4 several times</li>
      </ol>

      <h2>Expected result</h2>
      <p>The map should continue to work without any problems</p>

      <h2>Actual result</h2>
      <p>
        Safari either hits a canvas memory limit with the warning "Total canvas
        memory use exceeds the maximum limit (288 MB)." in the devtools console
        or fails with the message "This web page was reloaded because a problem
        occured"
      </p>

      <button id="create-map-button" disabled>Create map</button>
      <button id="destroy-map-button">Destroy map</button>
    </div>

    <div id="map" class="map"></div>

    <script src="index.js"></script>
  </body>
</html>
